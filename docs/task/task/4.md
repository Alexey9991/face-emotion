# 4. Обучение и обновление моделей

Данная лабораторная работа направлена на приобретение навыков разработки компонентов архитектуры, обеспечивающих обучение и обновление моделей обработки данных.

::: tip Примечание
Под обновлением модели понимается использование **данных, которые появляются после обучения модели**, для обновления ее параметров и повышения качества работы. В частности, могут использоваться следующие стратегии:
1. Выгрузка обученной модели, фиксация первых N слоев модели и оптимизация оставшихся параметров на заданных элементах выборки;
1. Выгрузка обученной модели, оптимизация всех параметров модели на заданных элементах выборки.
:::

## Задание

Компоненты архитектуры, обеспечивающие обучение и обновление моделей, могут мапиться на один или более компонентов workflow, например:

1. Извлечение <tt label="Например, определение части речи каждого слова исходного текста" underlined>низкоуровневых</tt> признаков для модели А;
1. Извлечение <tt label="Например, построение синтаксической структуры предложения" underlined>высокоуровневых</tt> признаков для модели A;
1. Извлечение признаков для модели B;
1. Обучение моделей.

Необходимо сформировать одну или несколько моделей. После обучения (обновления) текущее состояние моделей необходимо сохранить в *model repo*.

Примеры шагов, которые могут выполняться при обучении модели:
1. Формирование признаков для обучения из выборки, сформированной на этапе 1 и сохранение результатов в *feature store*;
1. Первичное обучение модели с использованием данных из *feature store*, полученных на предыдущем шаге.

Примеры шагов, которые могут выполняться при обновлении модели:
1. Предобработка данных с использованием содержимого *source data store* и *feature store*, сохранение результатов в *feature store*;
1. Обновление обученной модели с использованием данных из *feature store*, полученных на предыдущем шаге.

## Пример

Обучение `svm` модели классификации комментариев для определения их эмоциональной окраски, см. конфигурацию соответствующего этапа `workflow` на [github actions](https://github.com/zeionara/ahri/actions/runs/3783395390/jobs/6431907161). Перед обучением модели выполняется векторизация текста, для чего текст каждого комментария разбивается на токены, формируется матрица [pmi](https://en.wikipedia.org/wiki/Pointwise_mutual_information) значений, для которой затем выполняется операция сокращения размерности. Полученные вектора используются в качестве исходных данных при обучении `svm` классификатора.
